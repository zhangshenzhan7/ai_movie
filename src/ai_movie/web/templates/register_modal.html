<!-- 模态框 - 注册 -->
<div id="registerModal" 
     class="fixed inset-0 bg-black/50 z-50 hidden items-center justify-center p-4"
     role="dialog"
     aria-modal="true"
     aria-labelledby="registerModalTitle">
    <div class="bg-white rounded-2xl shadow-card w-full max-w-md transform transition-all" role="document">
        <div class="p-6 md:p-8">
            <div class="flex justify-between items-center mb-6">
                <h3 id="registerModalTitle" class="text-2xl font-bold">注册</h3>
                <button id="closeRegisterModal" 
                        class="text-gray-medium hover:text-dark focus-visible:focus"
                        aria-label="关闭注册模态框">
                    <i class="fa fa-times text-xl" aria-hidden="true"></i>
                </button>
            </div>

            <form id="registerForm" novalidate>
                <div class="mb-4">
                    <label for="registerUsername" class="block text-sm font-medium text-gray-medium mb-2">
                        用户名 <span class="text-danger" aria-label="必填项">*</span>
                    </label>
                    <input type="text" 
                           id="registerUsername" 
                           name="username"
                           class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-primary focus:border-primary transition-colors" 
                           placeholder="请输入用户名" 
                           required
                           minlength="3"
                           maxlength="20"
                           pattern="[a-zA-Z0-9_\u4e00-\u9fa5]+"
                           aria-describedby="registerUsernameError registerUsernameHelp"
                           autocomplete="username">
                    <div id="registerUsernameHelp" class="text-gray-medium text-xs mt-1">
                        3-20个字符，仅支持字母、数字、下划线和中文
                    </div>
                    <div id="registerUsernameError" class="text-danger text-sm mt-1 hidden" role="alert"></div>
                </div>

                <div class="mb-4">
                    <label for="registerEmail" class="block text-sm font-medium text-gray-medium mb-2">
                        邮箱 <span class="text-danger" aria-label="必填项">*</span>
                    </label>
                    <input type="email" 
                           id="registerEmail" 
                           name="email"
                           class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-primary focus:border-primary transition-colors" 
                           placeholder="your@email.com" 
                           required
                           aria-describedby="registerEmailError"
                           autocomplete="email">
                    <div id="registerEmailError" class="text-danger text-sm mt-1 hidden" role="alert"></div>
                </div>

                <div class="mb-4">
                    <label for="registerPassword" class="block text-sm font-medium text-gray-medium mb-2">
                        密码 <span class="text-danger" aria-label="必填项">*</span>
                    </label>
                    <div class="relative">
                        <input type="password" 
                               id="registerPassword" 
                               name="password"
                               class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-primary focus:border-primary transition-colors" 
                               placeholder="至少 8 个字符" 
                               required
                               minlength="8"
                               aria-describedby="registerPasswordError registerPasswordHelp passwordStrength"
                               autocomplete="new-password">
                        <button type="button" 
                                id="toggleRegisterPassword"
                                class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-medium hover:text-dark focus-visible:focus"
                                aria-label="显示/隐藏密码">
                            <i class="fa fa-eye" aria-hidden="true"></i>
                        </button>
                    </div>
                    <div id="registerPasswordHelp" class="text-gray-medium text-xs mt-1">
                        密码应包含大小写字母、数字和特殊字符
                    </div>
                    <div id="passwordStrength" class="mt-2 hidden">
                        <div class="flex space-x-1 mb-1">
                            <div class="h-1 flex-1 bg-gray-200 rounded" id="strength1"></div>
                            <div class="h-1 flex-1 bg-gray-200 rounded" id="strength2"></div>
                            <div class="h-1 flex-1 bg-gray-200 rounded" id="strength3"></div>
                            <div class="h-1 flex-1 bg-gray-200 rounded" id="strength4"></div>
                        </div>
                        <div id="strengthText" class="text-xs text-gray-medium"></div>
                    </div>
                    <div id="registerPasswordError" class="text-danger text-sm mt-1 hidden" role="alert"></div>
                </div>

                <div class="mb-4">
                    <label for="confirmPassword" class="block text-sm font-medium text-gray-medium mb-2">
                        确认密码 <span class="text-danger" aria-label="必填项">*</span>
                    </label>
                    <input type="password" 
                           id="confirmPassword" 
                           name="confirm_password"
                           class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-primary focus:border-primary transition-colors" 
                           placeholder="请再次输入密码" 
                           required
                           aria-describedby="confirmPasswordError"
                           autocomplete="new-password">
                    <div id="confirmPasswordError" class="text-danger text-sm mt-1 hidden" role="alert"></div>
                </div>

                <div class="mb-6">
                    <label class="flex items-start">
                        <input type="checkbox" 
                               id="agreeTerms" 
                               name="agree_terms"
                               class="w-4 h-4 text-primary bg-gray-100 border-gray-300 rounded focus:ring-primary focus:ring-2 mt-0.5"
                               required>
                        <span class="ml-2 text-sm text-gray-medium">
                            我已阅读并同意
                            <a href="#" class="text-primary hover:underline focus-visible:focus">用户协议</a>
                            和
                            <a href="#" class="text-primary hover:underline focus-visible:focus">隐私政策</a>
                        </span>
                    </label>
                    <div id="agreeTermsError" class="text-danger text-sm mt-1 hidden" role="alert"></div>
                </div>

                <button type="submit" 
                        id="registerSubmitBtn"
                        class="w-full py-3 rounded-lg bg-primary text-white font-semibold hover:bg-primary/90 transition-colors mb-4 focus-visible:focus disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center"
                        aria-describedby="registerFormError">
                    <span class="register-btn-text">注册</span>
                    <div class="register-spinner hidden ml-2">
                        <div class="spinner"></div>
                    </div>
                </button>
                
                <div id="registerFormError" class="text-danger text-sm mb-4 hidden" role="alert"></div>

                <p class="text-center text-gray-medium">
                    已有账号? 
                    <button type="button" 
                            id="switchToLogin" 
                            class="text-primary font-medium hover:underline focus-visible:focus">
                        立即登录
                    </button>
                </p>
            </form>
        </div>
    </div>
</div>